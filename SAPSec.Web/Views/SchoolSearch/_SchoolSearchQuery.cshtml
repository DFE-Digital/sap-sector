@using SAPSec.Web.Constants
@using SAPSec.Web.Extensions
@using SAPSec.Web.ViewModels
@model SchoolSearchQueryViewModel
@{
    var hasError = ViewData.ModelState.HasError(nameof(SchoolSearchQueryViewModel.Query));
}
@using (Html.BeginForm(FormMethod.Post, true, new { novalidate = "novalidate", role = "search" }))
{
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            @await Html.PartialAsync("_ErrorSummary")
            <div class="govuk-form-group @(hasError ? "govuk-form-group--error" : string.Empty)">
                <h1 class="govuk-label-wrapper">
                    <label class="govuk-label govuk-label--l" for="__@nameof(SchoolSearchQueryViewModel.Query)">
                        @ViewData[ViewDataKeys.Title]
                    </label>
                </h1>
                <div id="@nameof(SchoolSearchQueryViewModel.Query)-hint" class="govuk-hint">
                    @Model.Hint
                </div>
                @if (hasError)
                {
                    <p id="@nameof(SchoolSearchQueryViewModel.Query)-error" class="govuk-error-message">
                        <span class="govuk-visually-hidden">Error:</span>
                        @ViewData.ModelState[nameof(SchoolSearchQueryViewModel.Query)]?.Errors.Select(e => e.ErrorMessage).FirstOrDefault()
                    </p>
                }
                <div class="govuk-input__wrapper">
                    <div class="school-search-suggester-wrapper">
                        <input
                            id="@nameof(SchoolSearchQueryViewModel.Query)"
                            name="@nameof(SchoolSearchQueryViewModel.Query)"
                            class="govuk-input @(hasError ? "govuk-input--error" : string.Empty)"
                            value="@Model.Query"
                            type="text" spellcheck="false"
                            data-fallback-input="true"
                            aria-describedby="@nameof(SchoolSearchQueryViewModel.Query)-hint @(hasError ? $"{nameof(SchoolSearchQueryViewModel.Query)}-error" : string.Empty)"/>
                    </div>
                    <div class="govuk-input__suffix govuk-input__suffix__button">
                        <button type="submit" class="govuk-button" data-module="govuk-button" name="action">
                            <img
                                src="/assets/images/magnify.svg"
                                alt="Search"
                                height="15"
                                width="15"/>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
}